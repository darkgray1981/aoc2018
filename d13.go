package main

import (
	"fmt"
	"sort"
	"strings"
	"time"
)

func main() {

	fmt.Println("Starting...")
	p1()
	p2()
}

var turn map[[3]byte]byte

func init() {
	turn = map[[3]byte]byte{
		[3]byte{'+', '^', 0}: '<',
		[3]byte{'+', '^', 1}: '^',
		[3]byte{'+', '^', 2}: '>',

		[3]byte{'+', '>', 0}: '^',
		[3]byte{'+', '>', 1}: '>',
		[3]byte{'+', '>', 2}: 'v',

		[3]byte{'+', 'v', 0}: '>',
		[3]byte{'+', 'v', 1}: 'v',
		[3]byte{'+', 'v', 2}: '<',

		[3]byte{'+', '<', 0}: 'v',
		[3]byte{'+', '<', 1}: '<',
		[3]byte{'+', '<', 2}: '^',

		[3]byte{'/', '^', 0}: '>',
		[3]byte{'/', '>', 0}: '^',
		[3]byte{'/', 'v', 0}: '<',
		[3]byte{'/', '<', 0}: 'v',

		[3]byte{'\\', '^', 0}: '<',
		[3]byte{'\\', '>', 0}: 'v',
		[3]byte{'\\', 'v', 0}: '>',
		[3]byte{'\\', '<', 0}: '^',
	}
}

type Cart struct {
	x     int
	y     int
	face  byte
	turn  byte
	alive bool
}

func drive(cart *Cart, track [][]byte) {
	switch cart.face {
	case '^':
		cart.y -= 1
	case '>':
		cart.x += 1
	case 'v':
		cart.y += 1
	case '<':
		cart.x -= 1
	default:
		panic("Cart broken!")
	}

	shape := track[cart.y][cart.x]

	switch shape {
	case 'X':
		cart.alive = false
	case '/', '\\':
		cart.face = turn[[3]byte{shape, cart.face, 0}]
	case '+':
		cart.face = turn[[3]byte{shape, cart.face, cart.turn}]
		cart.turn = (cart.turn + 1) % 3
	}
}

func p1() {

	t := time.Now()

	var track [][]byte
	loc := make(map[[2]int]*Cart)

	for y, s := range strings.Split(INPUT_TAEL, "\n") {

		row := make([]byte, len(s))

		for x, r := range s {
			c := byte(r)
			switch c {
			case '^', 'v':
				loc[[2]int{x, y}] = &Cart{x, y, c, 0, true}
				row[x] = '|'
			case '>', '<':
				loc[[2]int{x, y}] = &Cart{x, y, c, 0, true}
				row[x] = '-'
			default:
				row[x] = c
			}
		}

		track = append(track, row)
	}

	// draw(track, loc)
	// fmt.Println("Carts:", len(loc))

	step := 0

	// fmt.Printf("Step: %d", step)

outer:
	for len(loc) > 0 {

		carts := make([]*Cart, 0, len(loc))

		for _, cart := range loc {
			carts = append(carts, cart)
		}

		sort.Slice(carts, func(i, j int) bool {
			if carts[i].y == carts[j].y {
				return carts[i].x < carts[j].x
			}
			return carts[i].y < carts[j].y
		})

		for _, cart := range carts {
			if !cart.alive {
				continue
			}

			delete(loc, [2]int{cart.x, cart.y})
			drive(cart, track)

			if otherCart, exists := loc[[2]int{cart.x, cart.y}]; exists {
				fmt.Println("Collision:", cart.x, cart.y, "on step", step)
				track[cart.y][cart.x] = 'X'
				cart.alive = false
				otherCart.alive = false
				delete(loc, [2]int{cart.x, cart.y})

				break outer
			}

			if cart.alive {
				loc[[2]int{cart.x, cart.y}] = cart
			}
		}

		// draw(track, loc)

		step++
		// if step%1000 == 0 {
		// fmt.Printf("\rStep: %d", step)
		// }

		// var input string
		// fmt.Scanln(&input)
	}

	// draw(track, loc)

	fmt.Println("Done:", len(loc), time.Since(t))
}

func p2() {

	t := time.Now()

	var track [][]byte
	loc := make(map[[2]int]*Cart)

	for y, s := range strings.Split(INPUT_TAEL, "\n") {

		row := make([]byte, len(s))

		for x, r := range s {
			c := byte(r)
			switch c {
			case '^', 'v':
				loc[[2]int{x, y}] = &Cart{x, y, c, 0, true}
				row[x] = '|'
			case '>', '<':
				loc[[2]int{x, y}] = &Cart{x, y, c, 0, true}
				row[x] = '-'
			default:
				row[x] = c
			}
		}

		track = append(track, row)
	}

	// draw(track, loc)
	// fmt.Println("Carts:", len(loc))

	step := 0

	// fmt.Printf("Step: %d\n", step)

	for len(loc) > 1 {

		carts := make([]*Cart, 0, len(loc))

		for _, cart := range loc {
			carts = append(carts, cart)
		}

		sort.Slice(carts, func(i, j int) bool {
			if carts[i].y == carts[j].y {
				return carts[i].x < carts[j].x
			}
			return carts[i].y < carts[j].y
		})

		for _, cart := range carts {
			if !cart.alive {
				continue
			}

			delete(loc, [2]int{cart.x, cart.y})
			drive(cart, track)

			if otherCart, exists := loc[[2]int{cart.x, cart.y}]; exists {
				// fmt.Println("\nCollision: ", cart.x, cart.y, "on step", step)
				// track[cart.y][cart.x] = 'X'
				cart.alive = false
				otherCart.alive = false
				delete(loc, [2]int{cart.x, cart.y})
			}

			if cart.alive {
				loc[[2]int{cart.x, cart.y}] = cart
			}
		}

		// draw(track, loc)

		step++
		// if step%1000 == 0 {
		// 	fmt.Printf("\rStep: %d", step)
		// }

		// var input string
		// fmt.Scanln(&input)
	}

	// draw(track, loc)

	var finalCart *Cart
	for _, c := range loc {
		finalCart = c
	}

	fmt.Println("Done 2:", finalCart.x, finalCart.y, time.Since(t))
}

func draw(track [][]byte, loc map[[2]int]*Cart) {
	for y, row := range track {
		for x, c := range row {
			cart := loc[[2]int{x, y}]
			if cart != nil {
				c = cart.face
			}
			fmt.Printf("%c", c)
		}
		fmt.Println()
	}
}

const INPUT1 = `/->-\        
|   |  /----\
| /-+--+-\  |
| | |  | v  |
\-+-/  \-+--/
  \------/   `

const INPUT2 = `/>-<\  
|   |  
| /<+-\
| | | v
\>+</ |
  |   ^
  \<->/`

const INPUT = `                                             /---------------------------------------------------------------------------------------------\          
 /----------------------<--------------------+----------------------------\                                                                |          
 |                                           |                            |                                                                |          
 |  /------------------\                     |                            |                              /--------------\                  |          
 |  |                  |                     |                            |                              |              |                  |          
 |  |                  |                     |       /--------------------+------------------------------+--------------+-------\          |          
 |  |                  |                     |       |      /-------------+------------------------------+--------------+-------+----------+-----\    
 |  |                  |                     |       |     /+-------------+-----------------\            | /------------+-------+--------\ |     |    
 |  |                  |                     |       |     ||             |                 |            | |            |       |        | |     |    
 |  |         /--------+---------------------+-------+-----++-------------+-------<---------+------------+-+--------\   |       |        | |     |    
 |  |         |   /----+---------------------+-------+-----++-------------+-----------------+------------+-+-----\  |   |       |        | |     |    
 |  |         |   |    |            /--------+-------+-----++-------------+------------\    |     /------+-+-\   |  |   |       |        | |     |    
 |  |         | /-+----+------------+--------+-------+-----++-------------+------------+----+-----+-\    | | |   |  |   |       |     /--+-+-----+---\
 |  |    /----+-+-+----+------------+--------+-------+-----++---\         |            |    | /---+-+----+-+-+---+--+---+-------+-----+--+\|     |   |
 |  |    |    | |/+----+------------+--------+-------+-----++---+---------+------------+----+-+---+\|    | | |   |  |   |       |  /--+--+++--\  |   |
 |  |   /+----+-+++----+------------+--------+-------+-----++---+---\     |            |    | |   |||    | | |   |  |   |       |  |  |  |||  |  |   |
 |  |   ||    | |||    |         /--+--------+\      |     ||   |  /+-----+------------+---\| |   |||    | | |   |  |   |       |  |  |  |||  |  |   |
 |  |   ||    | |||    |         |  |        ||   /--+-----++---+--++-----+------------+---++-+---+++----+-+-+---+--+---+-------+--+--+--+++--+--+\  |
 |  |   ||    | ||| /--+---------+--+-\/-----++-\ | /+-----++---+\ ||     |            |   || |   |||    | | |   |  |   | /-----+--+--+--+++\ |  ||  |
 |  |   ||    | ||| |  |         |  | ||     || | | ||     ||   || ||     |            |   || |   |||    | | |   |  |   | ^     |  |  |  |||| |  ||  |
 |  |   ||    | ||| |  |    /----+--+-++-----++-+-+-++-----++---++-++-\   |            |   || |   |||    | | |   |  |   | |     |  |  |  |||| |  ||  |
 |  |   ||    | ||\-+--+----+----+--+-++-----++-+-+-++-----++---++-++-+---+------------+---++-+---+++----+-+-+---/  |   | |     |  |  |  |||| |  ||  |
 |  | /-++----+-++--+--+----+-->-+--+-++-----++-+-+-++-----++>--++-++-+---+------------+---++\|   |||    | | |      |   | |     |  |  |  |||| |  ||  |
 |  | | ||    | ||  |  |    |    |  | ||     || | | ||     ||   || || |   |            |   ||||   |||    | | |      |   | |     |  |  |  |||| |  ||  |
 |  | | ||    | ||  |  |    |    |  \-++-----++-+-+-++-----++---++-++-+---+------------/   ||||   |||   /+-+-+------+---+-+-----+-\|  |  |||| |  ||  |
/+--+-+-++----+-++--+--+----+----+----++-----++\| | ||     ||   || || |   |                ||||   |||/--++-+-+--\   |   | |     | ||  |  |||| |  ||  |
||  | | ||    | ||  |  |    | /--+----++-----++++-+-++-----++---++-++-+---+----------------++++\  ||||  || | |  |   |   | |     | ||  |  |||| |  ||  |
||  | | \+----+-++--+--+----+-+--+----++-----++++-+-++-----++---++-+/ |   |                |||\+--++++--++-+-+--+---+---+-+-----+-++--+--+/|| |  ||  |
||  | |  \----+-++--+--+----+-+--+----++-----++++-+-++-----++---/| |  |   |                ||| |  ||||  || | |  |   |  /+-+-----+-++--+--+-++-+-\||  |
||  | |       | ||  |  |   /+-+--+---\||     |||| \-++-----++----+-+--+---+----------------+++-+--++++--++-+-+--+---+--++-+-----+-++--+--+-++-+-++/  |
||  | |       | ||  |  |   || |  |   |||     ||||   ||    /++----+-+\ |   |                ||| |  ||||  || | |  |   |  || |     | ||  |  | || | ||   |
||  | |       | ||  |  |/--++-+--+---+++-----++++---++----+++----+-++-+---+-------\        ||| |  ||||  || | |  |   |  || \-----+-++--+--+-+/ | ||   |
||  | |       | ||  |  ||  || |  |   |||     ||||   ||  /-+++----+-++-+---+-------+--------+++\|  ||||  || | |  |   |  ||       | ||  |  | |  | ||   |
||  | |       | ||  |  ||  || |  |   |||     ||||   ||  | |||    | || |   |       |        ||||| /++++--++-+-+--+---+--++------\| ||  |  | |  | ||   |
||  | |       | ||  |  ||  || |  |   |||     ||||   ||/-+-+++----+-++-+---+-------+--------+++++\|||||  || | |  |   |  ||      || ||  |  | |  | ||   |
||  | |       | ||  | /++--++-+--+---+++-----++++---+++-+-+++----+-++-+-\ |       |   /----+++++++++++--++-+-+--+---+--++------++-++--+--+-+--+-++\  |
||  | |       | ||  | |||  || |  |   |||     ||||   ||| | |||    | || | | |       |/--+----+++++++++++--++-+-+--+-\ |  ||      || ||  |  | |  | |||  |
|\--+-+-------+-++--+-+++>-++-+--+---+++-----++++---+++-+-+++----+-++-+-+-/ /-----++--+----+++++++++++--++-+-+--+-+-+--++------++-++--+--+-+--+\|||  |
|   | |       | ||  | |||  || | /+---+++-----++++---+++\|/+++----+-++-+-+---+-----++--+----+++++++++++--++-+-+--+-+-+--++-\    || ||  |  | |  |||||  |
|  /+-+-------+-++--+\|||  |v | ||   |||     ||||   ||||||\++----+-+/ | |   |     ||  |    |||||||||||  || | |  | | |  || |    || ||  |  | |  |||||  |
|  || |       | ||  |||||  || | ||   |||/----++++---++++++-++----+-+--+-+---+-----++--+----+++++++++++--++-+-+\ | | |  || |    || ||  |  | |  |||||  |
|  || |       | ||  |||||  || | ||   ||||    ||||   |||||| ||    | |  | |   |  /--++--+----+++++++++++--++-+-++-+-+-+--++-+----++-++--+--+-+\ |||||  |
| /++-+-------+-++--+++++--++-+-++---++++----++++---++++++-++----+-+--+-+---+--+--++--+----+++++++++++--++-+\|| | | |  || |    || ||  |  | || |||||  |
|/+++-+-------+-++--+++++--++-+-++---++++----++++---++++++-++\   | |  | |   |  |  ||  |    |||||||||||  || |||| | | |  || |    || ||/-+--+-++-+++++-\|
||||| |       | ||  |||||  || | ||   ||||    ||||   |||||| |||   | |  | |   |  |  ||  |    |||||||||||  || |||| | | |  ||/+----++-+++-+--+\|| ||||| ||
||||| |       | ||  |||||  || | ||   ||||/---++++---++++++-+++\  | |  | |   |  |  ||  |    |||||||||||  || |||| | | |  ||||    || ||| |  |||| ||||| ||
||||| |       | ||  |||||  || | ||   |||||   ||||   |||||| ||||  | |  | | /-+--+-<++--+----+++++++++++--++-++++-+-+-+--++++----++-+++-+--++++-+++++\||
||||| |       | ||  |||||  || | |\---+++++---+/||   |||||| ||||  | |  | |/+-+--+--++--+----+++++++++++--++-++++\| | |  ||||    || ||| |  |||| ||||||||
||||| |     /-+-++--+++++--++-+-+----+++++---+-++-\ |||||| ||||/-+-+--+-+++-+--+--++--+----+++++++++++\ || |||||| | |  ||||    || ||| |  |||| ||||||||
||||| |     | |/++--+++++--++-+-+----+++++---+-++-+-++++++-+++++-+-+--+-+++-+--+--++-\|    |||||||||||| || |||||| | |  ||||    || ||| |  |||| ||||||||
||||| |     | ||||  |||||  || | |    |||||   | || | |||||\-+++++-+-+--+-+++-+--+--++-++----++++++++++++-++-++++++-+-+--+++/    || ||| |  |||| ||||||||
||||| |     | ||||  |||||  || | |    ||||| /-+-++-+-+++++--+++++-+-+--+-+++-+--+--++-++----++++++++++++-++-++++++\| |  |||     || |\+-+--++++-/|||||||
||||| |     | ||||  |||||  || | |    ||||| | | || | ||||| /+++++-+-+--+-+++-+--+--++-++----++++++++++++\|| |||||||| |  |||     || | | |  ||||  |||||||
||||| |     | ||||  ||||| /++-+-+----+++++-+-+-++-+-+++++-++++++-+-+--+-+++-+--+--++-++----+++++++++++++++-++++++++-+\ |||     || | | |  ||||  |||||||
||||| |     | ||||  ||||| ||| | |  /-+++++-+-+-++-+-+++++-++++++-+-+--+-+++-+--+--++\||    |||||||\+++++++-++/||||| || |||  /--++-+-+-+--++++\ |||||||
||||| |     | ||||  \++++-+++-+-+--+-+/||| | | || | ||||| |||||| | |  | ||\-+--+--+++++----+++++++-+++++++-++-+++++-++-+++--+--++-+-+-+--+++++-++++/||
||||| |     | ||||   |||| ||| | |  | | ||| | | || | \++++-++++++-/ |  | ||  |  |  ||||\----+++++++-+++++++-++-+++++-++-+++--+--++-+-+-+--+++++-+++/ ||
||||| |     | ||||   |||| ||| | |  | | ||| | | || |  |||| ||||||   |  | ||  |  |  ||||     ||||||| ||||||| || ||||| || |||  |  || | | |  ||||| |||  ||
||||| |     | ||||   |||| ||| | |  | | ||| | | || |  |||| ||||||   |  | ||  |  |  ||||     ||||||\-+++++++-++-+++++-++-+++--+--/| | | v  ||||| |||  ||
||||| |     | ||||   |||| ||| |/+--+-+-+++-+-+-++-+--++++-++++++---+-\| ||  |  |  ||||     ||||||  ||||||| || ||||| || |||  |   | | | |  ||||| |||  ||
||||| |     | ||||   |||| ||| |||  | | ||| | | || |  \+++-++++++---+-++-++--+--+--++++-----++++++--+++++++-++-+++++-++-+++--+---/ | | |  ||||| |||  ||
||||| |     | ||||   |||| ||| |||  | | ||| | | || |   ||| ||||||   | || ||  |  |  ||||     ||||||  ||||||| || ||||| || |||  |     | | |  ||||| |||  ||
\++++-+-----+-++++---++++-+++-+++--+-+-+++-+-+-/|/+---+++-++++++---+-++-++--+--+\ ||||     ||||||  ||||||| \+-+++++-++-+++--+-----+-+-+--/|||| |||  ||
 |||| |     | |||| /-++++-+++-+++--+-+-+++-+-+--+++---+++-++++++---+-++-++\ |  || ||||     ||||||  |||||||  | ||||| || |||  |     | | |   |||| |||  ||
 |||| |   /-+-++++-+-++++-+++-+++--+-+-+++-+-+--+++---+++-++++++---+-++-+++-+--++-++++-----++++++--+++++++--+-+++++\|| |||  |     | | |   |||| |||  ||
 |||| |   | | |||| | |||| ||| |||  | | ||| | |  |||   ||| ||||||   | ||/+++-+--++-++++-----++++++--+++++++--+-++++++++-+++--+-----+-+-+---++++-+++\ ||
 |||| |   | | |||| | |||| ||| |||  | | ||| | |  |||   ||| ||||||   \-++++++-+--++-++++-----/|||||  |||||||  | |||||||| |||  |     | | |   |||| |||| ||
 \+++-+---+-+-++++-+-++++-+++-+++--+-+-+++-+-+--+++---+++-+++/|\-----++++++-+--++-++++------+++++--+++/|||  | |||||||| |||  |     | | |   |||| |||| ||
  ||| |   | | |||| |/++++-+++-+++-\| | ||| | |  |||   ||| ||| |      |||||| |  || ||||     /+++++--+++-+++--+-++++++++-+++--+-----+-+-+--\|||| |||| ||
  ||| |   | | |||| |||||| ||| ||| || | ||| | |  |||   ||| ||| |      |||||| | /++-++++-----++++++--+++-+++--+-++++++++-+++-\|     | | \--+++++-++++-+/
  ||| |   | | |||| |||||| ||| ||| || | ||| | |  |||   ||| ||| |      |||||| | ||| ||||     ||||||  ||| |||  | |||||||| ||| ||     | |    ||||| |||| | 
  ||| |   | | |||| |||||| |||/+++-++-+-+++-+-+--+++---+++-+++-+------++++++-+-+++-++++-----++++++--+++-+++--+-++++++++-+++\||     | |    ||||| |||| | 
 /+++-+---+-+-++++-++++++-+++++++-++-+-+++-+-+--+++---+++-+++-+------++++++-+-+++\||||     ||||||  ||| |||  | |||||||| ||||||     | \----+++++-++++-/ 
 |||| |   | | |||| |||||| ||||||| || | ||| | |  |||   ||| ||| |      |||||| | ||||||||     ||||||  ||| |\+--+-++++++++-++++++-----/      ||||| ||||   
 |||| |   | | |||| |||||| ||||||| || | ||| | |  |||   ||| ||| |      ||\+++-+-++++++++-----++++++--+++-+-+--+-++++++++-++++++------------+++++-+++/   
 |||\-+---+-+-++++-++++/| ||||||| || | ||| | |  |||   ||| ||| |      || ||| | ||||||||   /-++++++-\||| | |  | |||||||| ||||||            ||||| |||    
 |||  |   | | |||| ||||/+-+++++++-++-+-+++-+-+--+++---+++-+++-+------++-+++-+-++++++++---+-++++++-++++-+-+--+-++++++++-++++++-----\      ||||| |||    
 |||  |   | | |||| |||||| ||||||| || | ||| | |  |||   ||| ||| |      || ||| | ||||||||   | |||||| |||| | |  | |||||||| ||||||     |  /---+++++-+++-\  
 |||  |   | | |||| |\++++-+++++++-/| |/+++-+-+--+++---+++-+++-+------++-+++-+-++++++++---+-++++++-++++-+-+--+-++++++++-++++++-\   |  |   ||||| ||| |  
 |||  |   | | |||| | |||| |||||||  | |||||/+-+--+++---+++-+++-+----\ || |\+-+-++++++++---+-++++++-++++-+-+--+-+/|||||| |||||| |   |  |   ||||| ||| |  
 |||  |   | | |||| | |||| ||||\++--+-+++++++-+--+++---+++-+++-+----+-++-+-+-+-++++++++---+-++++/| |||| | |  | | |||||| |||||| |   |  |   ||||| ||| |  
 |||  |   | | |||| | |||| |||| ||  | ||||||| |  |||   ||| ||| |    | || | | | ||||||||   | |||| | |||| | |  | | |||||| |||||| |   |  |   ||||| ||| |  
 |||  |   | | |||| | |||| |||| ||  | ||||||| |  |||   ||| ||| |    | || | | | ||||||||   | |||| | |||| | |  | | |||||| |||||| |   |  |   ||||| ||| |  
 |||  |   | | |||| | ||||/++++-++--+-+++++++-+--+++---+++-+++-+----+-++-+-+-+-++++++++---+>++++-+-++++-+-+--+-+\|||||| |||||| |   |  |   ||||| ||| |  
 |||  |   | | |||| | ||||||||| ||  | ||||||\-+--+++---+++-+++-+----+-++-+-+-+-++++++++---+-++++-+-++++-+-+--+-+++/|||| |||||| |   |  |   ||||| ||| |  
 |||  |/--+-+-++++-+-+++++++++-++--+-++++++--+--+++---+++-+++-+----+-++-+-+-+-++++++++---+-++++-+-++++-+-+\ | ||| |||| |||||| |   |  |   ||||| ||| |  
 |||  ||  | | |||| | ||||||||| ||  | ||\+++--+--/||   ||| ||| |    | || | | | ||||||||   | |||| | |||| | || | ||| |||| |||||| |   |  |   ||||| ||| |  
 |||  ||  | | |||| | ||||||||| ||  | || |||  |   ||   ||| ||| |    | || | | | ||||||||   | |||| | |||| | || | ||| |||| |||||| |   |  |   ||||| ||| |  
 \++--++--+-+-++++-+-+++++++++-++--+-++-+++--+---++---+++-+++-+----+-++-+-+-+-+++/||||   | |||| | |||| | || | ||| |||| |||||| |   |  |   ||||| ||| |  
  ||  ||  | | |||| | ||||||||| ||  | || |||  | /-++---+++-+++-+----+-++-+-+-+-+++-++++---+-++++-+\|||| | || | ||| |||| |||||| |   |  |   ||||| ||| |  
  ||  ||  |/+-++++-+-+++++++++-++--+-++\|||  | | ||   ||| ||| |    | || | | | ||| ||||   | |||| |||||| |/++-+-+++-++++-++++++\|   |  |   ||||| ||| |  
  ||  ||  |||/++++-+-+++++++++\||  | ||||||  | | ||   ||| ||| |    | || | | | |\+-++++---+-++++-++++++-++++-+-+++-++++-++++++++---+--+---+++/| ||| ^  
  |\--++--++++++++-+-/|||||||||||  | ||||||  | | ||   ||| ||| |    | || | | | \-+-++++---+-++++-++++++-++++-+-+++-++++-++++/|||   |  |   ||| | ||| |  
  |   ||  |||||||| |  |||||||||||  | ||||||  | | ||   ||| |\+-+----+-++-+-+-+---+-++++---+-+/|| |||||| |||| | ||| |||| |||| |||   |  \---+++-+-+++-/  
  |   ||  |||||||| |  |||||||||||/-+-++++++--+-+-++---+++-+-+-+----+-++-+-+-+---+-++++---+-+-++-++++++-++++-+-+++-++++-++++-+++--\|      ||| | |||    
  |   \+--++++++++-+--++++++++++++-+-++++++--+-+-++---+++-+-+-+----+-++-+-+-+---+-++++---+-+-/| |||||| |||| | ||| |||| |||| |||  ||      ||| | |||    
  |    |  |||||\++-+--++++++++++++-+-++++++--+-+-++---+++-+-+-+----+-++-+-+-+---+-+++/   | |  | |||||| |||| | ||| |||| |||| |||  ||      ||| | |||    
  |    \--+++++-++-+--++++++++++++-+-++++++--+-+-++---+++-+-+-+----+-++-+-+-+---+-+++----+-+--+-++++++-+++/ | ||| |||| |||| |||  ||      ||| | |||    
/-+-------+++++\|| |  |||||||||||| | ||||||  \-+-++---+++-+-+-+----+-++-+-+-+---+-+++----+-+--+-++++++-+++--+-+++-++++-++++-+++--++------++/ | |||    
| |       ||||\+++-+--++++++++++++-+-++++++----+-++---+++-+-+-+----+-++-+-+-+---+-+++----+-+--+-++++++-+++--+-+++-++/| |||| |||  ||      ||  | |||    
| |       |||| ||| |  |||||||||||| | ||||||    | ||   ||| | \-+----+-++-+-+-+---+-+++----+-+--+-++++++-+++--+-+++-++-+-++++-+++--++------++--+-++/    
| |       |||| ||| |  |||||||||||| | ||||||    | ||   ||| |   |    | || | | \---+-+++----+-+--+-++++++-+++--+-+++-++-+-++++-+++--++------++--+-/|     
| |       |||| ||| |  ||||||||||\+-+-++++++----+-++---+/|/+---+----+\|| | |     | |||    | |  | |||||| ||\--+-+++-++-+-+/|| |||  ||      ||  |  |     
| |       |||| ||| |  |||||||^|\-+-+-++++++----+-++---+-+++---+----++/| | |     | |||    | |  | |||||| ||  /+-+++-++-+-+-++-+++--++----\ ||  |  |     
| |       |||| ||| |  ||||||\++--+-+-++++++----+-++---+-+++---+----++-/ | |     | |||    | |  | |||||| ||  || ||| || | | || |||  ||    | ||  |  |     
| |       |||| ||| |  |||||| ||  | | ||||||    | ||   | |||   |    ||   | |     | |||    | |  | |||||\-++--++-++/ || | \-++-+++--++----+-++--+--/     
| |       |||| ||| |  ||\+++-++--+-+-++++++----+-++---+-+++---+----++---+-+-----+-/|| /--+-+--+-+++++--++--++-++--++-+---++-+++--++---\| ||  |        
| |       ||\+-+++-+--++-+++-++--+-+-++++++----+-+/   | |||   |    ||   | |     |  || |  | |  | |||||  ||  || ||  || |   || |||  ||   || ||  |        
| |       || | ||| |  || ||| ||  \-+-++++++----+-+----+-+++---+----++---+-+-----+--++-+--+-+--+-+++++--++--++-++--++-+---++-+++--/|   || ||  |        
| |       || | ||| |  || ||| ||    | ||||||    | |    |/+++---+----++---+-+-----+--++-+--+-+--+-+++++--++--++-++--++-+---++-+++---+---++-++--+-----\  
| |       || | ||| |  || ||| ||    | |||\++----+-+----+++++---+----++---+-+-----+--++-+--+-+--+-+++++--++--++-/|  || |   || |||   |   || ||  |     |  
| |       || | |||/+--++-+++-++----+-+++-++----+-+----+++++---+----++---+-+-----+--++-+--+-+--+-+++++--++--++\ |  || |   || |||   |   || ||  |     |  
| |       || | |||||  || \++-++----+-+++-++----+-+----+++++---+----++---+-+-----+--++-+--+-+--+-+++++--++--+++-/  || |   || |||   |   || ||  |     |  
| |       || | ||||\--++--++-++----+-+++-++----+-+----+++++---+----++---+-/     |  || |  | |  | |||||  ||  |||    || |   || |||   |   || ||  |     |  
| |       |\-+-++++---++--++-++----+-++/ ||    | \----+++++---+----++---+-------/  || |  | |  | |||||  ||  |||    || |   || \++---+---++-++--/     |  
|/+-------+--+-++++---++--++-++----+-++--++\   |      |||||   |    ||   |          || |  | \--+-+++++--++--+++----++-+---++--++---+---++-/|        |  
|||       |  | ||||   ||  || ||    | ||  |||   |      ||\++---+----++---+--->------++-+--+----/ |||||  ||  |||    || |   \+--++---+---++--/        |  
|||       |  | |\++---++--++-++----+-++--+++---+------++-++---+----++---+----------++-+--+------++++/  ||  |||    || |    |  ||   |   ||           |  
|||       |  | | ||   ||  || ||/---+-++--+++---+---\  || \+---+----+/   |  /-------++\|  |      ||||   ||  \++----++-+----+--++---+---+/           |  
|||       |  | | \+---++--++-+++---+-++--+++---+---+--++--+---+----+----+--+-------++++--+------+++/   ||   ||    || |    |  ||   |   |            |  
|||/------+--+-+--+---++--++-+++---+-++--+++---+---+--++--+---+--\ |    |  |       |||\--+------+++----++---++----++-+----+--++---+---/            |  
||||      |/-+-+--+---++--++-+++---+-++--+++---+---+--++--+---+--+-+----+--+\      \++---+------+++----++---++----/| |    |  ||   |                |  
||||      || | |  |   ||  || |||   | ||  |||   |   |  ||  |   |  | |    |  ||/------++---+------+++----++---++-----+-+----+--++---+-----\          |  
||||      || | |  |  /++--++-+++---+-++--+++---+---+--++--+---+--+-+----+--+++------++---+------+++<---++---++-----+-+----+--++-\ |     |          |  
||||      ||/+-+--+--+++--++-+++\  | ||  |||   |   |  ||  |   |  | |    |  |||      ||   |      |||/---++---++-----+-+---\|  || | |     |          |  
||||      |||| |  |  |||  \+-++++--+-++--+++---+---+--++--+---+--+-+----+--+++------++---+------++++---++---++-----+-/   ||  || | |     |          |  
||||      |||| |  |  |||   | ||||  | ||  |||   |   |  ||  |   |  | |    |  |||      ||   |      ||||   ||   ||     |     ||  || | |     |          |  
||||      |||| |  |  |||   | ||||  | ||  |||   |   |  ||  |   |  | |    |  \++------+/   |      ||||   ||   ||     |     ||  || | |     |          |  
\+++------++++-/  |  |||   | ||||  | ||  |\+---+---+--++--+---+--+-/    |   ||      |    |      ||||   ||   ||     |     ||  || | |     |          |  
 |||      ||||    |  |\+---+-++++--+-++--+-+---+---+--++--+---+--+------/   ||      |   /+------++++---++---++-----+-----++--++-+-+-----+------\   |  
 |||      ||||    |  | |   | ||||  | |\--+-+---+---+--++--+---+--+----------++------+---++------++++---++---++-----+-----++--+/ | |     |      |   |  
 |\+------++++----+--+-+---+-++++--+-+---+-+---+---+--++--+---+--+----------++------+---++------++++---++---/|     |     ||  |  | |     |      |   |  
 | |      ||||    |  | |   \-++++--+-/   | |   |   |  ||  \---+--+----------++------+---++------++++---/|    |     |     ||  |  | |     |      |   |  
 | |      ||||    |  | |     ||||  |     | |   |   |  ||      |  |          ||      |   ||      ||||    |    |     |     ||  |  | |     |      |   |  
 | |      ||||    |  \-+-----++++--+-----+-+---+---+--++------+--+----------++------+---++------++++----+----+-----+-----++--+--/ |     |      |   |  
 | |      ||||    |    |     ||||  |     | |   \---+--++------+--+----------++->----+---++------+/||    |    |     |     ||  |    |     |      |   |  
 | |      ||||    |    \-----++++--+-----+-+-------+--++------+--+----------++------+---++------+-++----+----+-----+-----++--+----/     |      |   |  
 | |      ||||    \----------++++--+-----+-+-------+--++------+--+----------++------+---++------+-++----+----/     |     ||  |          |      |   |  
 | |      ||||               ||||  |     \-+-------+--++------/  |          |\------+---++------+-++----+----------+-----++--+----------/      |   |  
 | |      ||||               ||\+--+-------+-------/  \+---------+----------+-------+---++->----/ ||    |          |     ||  |                 |   |  
 | |      |||\---------------+/ |  |       |           |         |          |       |   ||        ||    |          |     ||  |                 |   |  
 | |      ||\----------------+--/  \-------+-----------+---------+----------+-------/   ||        ||    |          |     ||  |                 |   |  
 | \------++-----------------+-------------+-----------+---------/          |           ||        ||    |          |     ||  |                 |   |  
 |        ||                 |             |           |                    |           |\--------/\----+----------+-----/|  |                 |   |  
 |        \+-----------------+-------------+-----------+--------------------+-----------+---------------+----------/      |  |                 |   |  
 \-<-------+-----------------+-------------/           |                    |           \---------------+-----------------+--+-----------------/   |  
           \-----------------+-------------------------+--------------------/                           |                 |  |                     |  
                             \-------------------------+------------------------------------------------+-----------------/  |                     |  
                                                       |                                                \--------------------/                     |  
                                                       \-------------------------------------------------------------------------------------------/  `

const INPUT_TAEL = `                    /--------------------------------------------------------------------------------------------------\                              
                    |                                     /-------------------------------------------------------\    |/-----------\                 
                    | /-----------------------------------+-----------------------------------\                   |   /++---------\ |                 
              /-----+-+--------------\                    |                                /--+---------------\   |   |||         | |                 
              |     | |/-------------+--------------------+---\                            |  |               |   |   |||         | |                 
              |   /-+-++-------------+--------------------+---+----<----------------------\|  |               |   |   |||         | |                 
              |   | | ||             | /------------------+---+---------------------------++--+---------------+---+---+++--\      | |                 
  /-----------+---+-+-++-------->----+-+------------------+---+---------------------------++--+-\       /-----+--\|   |||  |      | |                 
  |      /----+---+-+-++-------------+-+------------------+---+------\                    ||  | |       |     |  ||   |||  |      | |                 
  |      |    |  /+-+-++-------------+-+------------------+---+------+--------------------++--+-+-------+-----+--++---+++--+-\    | |                 
  |      |    |  || |/++------------\| |                 /+---+------+-----------\        ||  | |       |     |  ||   |||  | |    | |                 
  |      |    |  || ||||            || |                /++---+--\   |  /--------+--------++--+-+-------+-----+--++---+++--+-+----+-+-------------\   
  |      |/---+--++\||||            || |             /--+++---+--+---+--+--------+--------++--+-+-------+-----+--++---+++--+-+----+-+----\        |   
  | /----++---+--+++++++-----\      || |     /-------+--+++---+--+---+--+--------+--------++--+-+-------+-----+--++---+++--+-+----+-+----+--------+--\
  | |    ||   |  |||||||     |      || |     |     /-+--+++---+--+---+--+--------+--------++--+-+-------+-----+--++---+++--+-+----+-+----+---\    |  |
  | |    ||   |  |||||||     |      || |     |     |/+--+++---+--+---+--+--------+--------++--+-+-------+-----+-\||   |||  | |    | |    |   |    |  |
  | |    ||   |  |||||||     |      || |     |     |||  |||   |  |   |  |        |  /-----++--+-+-------+-----+-+++---+++--+-+----+\|    |   |    |  |
  | |    ||   |  |||||||     |      || |     |     |||  |||   |  |   |  |        |  |     ||  | |       |     | |||   |||  |/+----+++----+---+--\ |  |
  | |    ||   |  |||||||     |      || |     |  /--+++--+++---+--+---+--+--------+--+-----++--+-+-------+-----+-+++---+++--+++----+++-\  |   |  | |  |
  | |    ||/--+--+++++++-----+------++-+-----+--+--+++--+++---+--+---+--+--------+--+-----++--+-+------\|     | |||   |||  |||    ||| |  |   |  | |  |
  | |    |||  |  |||||||     |      || |     |  |  |||  |||   |  |   |  |        |  |     |\--+-+------++-----/ |||   |||  |||    ||| |  |   |  | |  |
/-+-+----+++--+--+++++++-----+------++-+---\ |  |  |||  \++---+--/   |  |        |  |     |   | |      ||       |||   |||  |||    ||| |  |   |  | |  |
| | |    |||  |  |||||||     |      || |   | |  |  |||   ||   |      |  |        | /+-----+---+-+------++-------+++--\|||  |||    ||| |/-+---+--+-+-\|
| | |    |||  |  |||||||     |      || |   | |  |  |||   \+---+------+--+--------/ || /---+---+-+------++-------+++--++++--+++----+++-++-+-\ |  | | ||
| | |    |||  |  |||||||     |      || |   | |  |  |||    |   |      |  | /--------++-+---+---+-+------++-------+++-\||||  |||    ||| || | | |  | | ||
| | |    |||  |  ||||||\-----+------++-+---+-+--+--+++----+---/      |  | |     /--++-+---+---+-+------++------\||| ||\++--+++----/|| || | | |  | | ||
| | |    |||  \--++++++------+------+/ |   | |  |  |||    |          |  | |     |  || |   |   | |      ||      |||| || ||  |||     || || | | |  | | ||
| |/+----+++--\  |||||\------+------+--+---+-+--+--+++----+----------+--+-+-----+--++-+---+---/ |      ||      |||| || ||  |||     || || | | |  | | ||
|/+++----+++--+--+++++-------+\     |  |   | |/-+--+++----+----------+--+-+-----+--++-+---+-----+------++------++++-++-++--+++-----++-++-+-+-+\ | | ||
|||||    |||  |  |||||       ||     |  |   | || |  |||    |          |  | |  /--+--++-+---+-----+------++------++++-++-++--+++\    || || | | || | | ||
|||||    \++--+--+++++-------++-----+--+---+-++-+--+++----+----------/  | |  |  |  || |   |     | /----++------++++-++-++--++++----++-++-+-+\|| | | ||
|||||     ||  |  |||||       ||     |/-+---+-++-+--+++----+-------------+-+--+--+--++-+--\|     | |    ||      |||| || ||  ||||    || || | |||| | | ||
|||||     ||  |  |||||       ||     || |   | || |  ||| /--+-------------+-+--+--+--++-+--++-----+-+-\  ||      |||| || ||  ||||    || || | |||| | | ||
|||||     ||  |  |||||       || /---++-+---+-++-+-<+++-+--+-----<-------+-+--+--+--++-+--++-\   | | |  ||      |||| || ||  ||||    || || | |||| | | ||
|||||     |\--+--+++++-------++-+---++-+---+-++-+--+++-+--+-------------+-+--+--+--++-+--++-+---+-+-+--/|      |||| || ||  ||||    || || | |||| | | ||
||||\-----+---+--+++++-------/| |   || |   | || |  ||| |  |             | |  |  |  || |  || |   | | |   |      |||| || ||  ||||    || || | |||| | | ||
|||\------+---/ /+++++--------+-+-\ || |   | || |  ||| |  |             | |  |  |  || |  || |   | | |   |      |||| || ||  ||||    || || | |||| | | ||
|||       |     |||||| /------+-+-+-++-+---+-++-+--+++-+--+-------------+-+--+--+--++-+--++-+---+-+-+---+------++++\|| ||  ||||    || || | |||| | | ||
|||       | /---++++++-+------+-+\| || |   |/++-+--+++-+--+-------------+-+--+--+--++-+--++-+---+-+-+---+------+++++++-++--++++-\  || || | |||| | | ||
|||       | |   |||||| |      | ||| || |   |||| |  ||| |  |             | |  |  | /++-+--++-+---+-+-+-\ | /----+++++++-++--++++-+--++-++-+-++++-+-+\||
|||       | |   |||||| |      | ||| || |/--++++-+--+++-+--+-------------+-+--+--+-+++-+--++-+---+-+-+-+-+-+---\||||||| ||  |||| |  || || | |||| | ||||
|||/------+-+---++++++-+---\  | ||| || || /++++-+--+++-+--+-------------+-+--+--+-+++-+--++-+\  | | | | | |   |||||||| ||  |||| |  || || | |||| | ||||
||||      | |   |||||| | /-+--+-+++-++-++-+++++-+--+++-+--+-------------+-+--+--+-+++\|  || ||  | | | | | |   |||||||| |\--++++-+--+/ || | |||| | ||||
||||      | |   |||||| | | |  | ||| || || ||||| |  ||| |  |             | |  |  | |||||  || ||  | \-+-+-+-+---++++++++-+---++++-+--+--++-+-+/|| | ||||
||||      | |  /++++++-+-+-+--+-+++-++-++-+++++-+--+++-+--+--\          | |  |  | |||||  || ||  |   | | | |   |||||||| |   |||| |  |  || | | || | ||||
||||      | |  ||||||| | | |  | ||| || || ||||| |  ||| |  |  |        /-+-+--+-\| |||||  || ||  |   | | | |   |||||||| |   |||| |  |  || | | || | ||||
||||/-----+-+--+++++++-+-+-+--+-+++-++-++-+++++-+--+++-+--+--+----\   | | |  |/++-+++++--++-++--+---+-+-+-+---++++++++-+--\|||| | /+--++-+-+\|| | ||||
|||||     | |  |||||\+-+-+-+--+-+++-++-++-+++++-+--+++-+--+--+----+---+-+-+--++++-+++++--++-++--+---+-+-+-+---++++++++-/  ||||| | ||  || | |||| | ||||
|||||   /-+-+--+++++-+-+-+-+--+-+++-++-++-+++++\|  ||\-+--+--+----+---+-+-+--++++-+++++--++-++--+---+-+-+-+---++++++++----+++++-+-++--++-/ |||| | ||||
|||||   |/+-+--+++++-+-+-+-+--+-+++-++-++-+++++++--++--+--+--+-\  |   |/+-+--++++-+++++--++-++--+---+-+-+-+---++++++++----+++++-+-++--++-\ |||| | ||||
|||||   ||| |  ||||| | | | |  | ||| || || ||||||| /++--+--+--+-+--+-\ ||| |  |||| |||||  || ||  |/--+-+-+-+---++++++++----+++++-+-++--++-+-++++\| ||||
|||||   ||| |  ||||| | | | |  | ||| || || ||||||| |||  |  |  | |  | | ||| |  |||| |||||  || ||  ||  | | | |   ||||||||    ||\++-+-++--++-+-+++++/ ||||
|||||   ||| |  ||||| | | | |/-+-+++-++-++-+++++++-+++--+--+--+-+--+-+\||| |  ||||/+++++--++-++--++--+-+-+-+---++++++++----++-++-+-++--++-+-+++++\ ||||
|||||   ||| |  ||||| | | | || | ||| || || ||||||| |||  |  |  | |  | ||||| |  ||||||||||  ^| ||  ||  | | | |   ||||||||    || || | ||  || | |||||| ||||
|||||   ||| |  ||||| | | | || | ||| ||/++-+++++++-+++--+--+--+\|  | ||||| |  \+++++++++--++-++--++--+-+-+-+---++++++++----++-+/ | ||  || | |||||| ||||
|||||   ||| |  ||||| | | |/++-+-+++-+++++-+++++++-+++--+--+--+++--+-+++++-+---+++++++++--++-++--++--+-+-+-+---++++++++----++-+-\| ||  || | |||||| ||||
|||||   ||| |  ||||| | | |||| | ||| ||||| ||||||| |||/-+--+--+++--+-+++++-+---+++++++++--++-++--++--+-+-+\|   ||||||||    || | || ||  || | |||||| ||||
|||||   |||/+--+++++-+-+-++++-+-+++-+++++-+++++++-++++-+--+--+++-\| ||||| |   ||\++++++--++-++--++--+-+-+++---+/||||||    || | || ||  || | |||||| ||||
|||||   |||||  ||||| | ^ |||| | ||| |||\+-+++++++-++++-+--+--+++-++-+++++-+---++-++++++--++-++--++--+-+-+++---+-++++++<---+/ | || ||  || | |||||| ||||
|||||   |||||  ||||| | | \+++-+-+++-+++-+-+++++++-++++-+--+--+++-++-+++++-+---++-++++/|  || ||  ||  | | |||   | ||||||    |  | || ||  || | |||||| ||||
||\++---+++++--+++++-+-+--+++-+-+++-+++-+-+++++++-++++-+--+--+++-++-+++++-+---++-++++-+--++-++--/|  | | |||   | ||||||    |  | || ||  || | |||||| ||||
|| ||   |||||  ||||| | |  ||| | ||| ||| | ||||||| |||| |  |  ||| || |||||/+---++-++++-+--++-++---+--+-+-+++---+-++++++----+--+-++-++--++-+\|||||| ||||
|| ||   |||||  ||||| | |  ||| | ||| ||| | ||||||| |||| |  |  ||| || |||||||   || ||||/+--++-++---+--+-+-+++---+-++++++----+-\| || ||  || |||||||| ||||
|| ||   |||||  ||||| | |  ||| | ||| ||| | ||||||| |||| |  |  ||| || |||||||   || \+++++--++-++---+--+-+-+++---+-++++++--->+-++-++-++--++-+++++++/ ||||
|| ||   |||||  ||||| | |  ||| | ||| ||| | ||||||| |\++-+--+--+++-++-+++++++---++--+++++--++-++---+--+-+-+++---+-++++++----+-++-++-++--++-++++/||  ||||
\+-++---+++++--+++++-+-+--+++-+-+++-+++-+-+/||||| | || |  |  ||| || |||||||   ||  |||||  || ||   |  | | |||   | ||||||    | || || ||  || |||| ||  ||||
/+-++---+++++--+++++-+-+--+++-+-+++-+++-+-+-+++++-+-++-+--+-\||| || |||||||   ||  |||||  || ||   |  | | |||   | ||||||    | || || ||  || |||| ||  ||||
|| ||   |||||  ||||| | |  ||| | ||| ||| | | ||||| |/++-+--+-++++-++-+++++++---++--+++++--++-++---+--+-+\||\---+-++++++----+-++-++-++--++-++++-++--+/||
|| ||   |||||  ||||| | |  \++-+-+++-+++-+-+-+++++-++++-+--+-++++-++-+++++++---++--+++++--++-++---+--+-++++----+-++++++----+-++-/| ||  || |||| ||  | ||
|| ||   |||||  ||^\+-+-+---++-+-+++-+++-+-+-+++++-++++-+--+-++++-++-+++++++---++--+++++--+/ ||   |  | ||||    | ||||||/---+-++--+-++--++-++++-++\ | ||
|| ||   |||||  ||| | | |   || | ||| ||| | | ||||\-++++-+--+-++++-++-+++++++---++--+++++--+--++---+--+-++++----+-+++++++---+-++--+-++--/| |||| ||| | ||
|| ||   |||||  ||| | | |   || |/+++-+++-+\| ||||  |||| |  | |||| || |||||||   ||  |||||  |  ||   |  | ||||    | |||||||   | ||  | ||   | |||| ||| | ||
|| ||   |||||  ||| | | |   || ||||| ||| ||| \+++--++++-+--+-++++-++-+++++++---++--+++++--+--++---+--+-++++----+-+++++++---+-++--/ ||   | |||| ||| | ||
|^ ||   |||||  ||| | | |   || ||||| ||| |||  |||  |||| |  | |||| || |||||||   ||  |||||  |  ||   |  | ||||    | |||||||   | ||    ||   | |||| ||| | ||
|| ||   |||||  ||| | | |   || ||||| ||| |||  |||  |||| | /+-++++-++-+++++++---++--+++++--+--++---+--+-++++----+-+++++++---+-++----++---+-++++-+++\| ||
|| ||  /+++++--+++-+-+-+---++-+++++-+++-+++--+++--++++-+-++-++++-++\|||||||   ||  |||\+--+--++---+--+-++++----+-+++++++---+-/|    ||   | |||| ||||| ||
|| ||  |||||| /+++-+-+-+---++\||||| ||| |||  |||  |||| | || |||| ||||||||||   \+--+++-+--+--++---+--+-++++----+-+++++++---/  |    ||   | |||| ||||| ||
|| ||  |||||| |||| | | |   |||||||| ||| |||  |||  |||| | |\-++++-++++++++++----+--+++-+--+--++---+--+-++++----+-++/||||      |    ||   | |||| ||||| ||
\+-++--++++++-++++-+-+-+---++++++++-+++-+++--+++--++++-+-+--/||| ||||||||||    |  \++-+--+--++---+--+-/|||  /-+-++-++++-\    |    ||   | |||| ||||| ||
 |/++--++++++-++++-+-+-+---++++++++-+++-+++--+++--++++\| |  /+++-++++++++++----+---++-+--+-\||   |  |  |||  | | || ||||/+----+---\||   | |||| ||||| ||
 ||||  |||||| |||| | | |   |||||||| ||| |||  |||  |||||| |  |||| ||||||||||    |   || |  | |||   |  |  |||  | | || ||||||    |   |||   | |||| ||||| ||
 ||||  |||||| |||| | | |   |||||||| ||| |||  \++--++++++-+--++++-++++++++++----+---++-+--+-+++---+--+--+++--+-+-++-++++++----+---+++---+-++++-+++++-+/
 ||||  |||\++-++++-/ | \---++++++++-+++-+++---++--++++++-+--++++-++++++++++----+---++-+--+-+++---+--+--+++--+-+-++-/|||||    |   |||   | |||| ||||| | 
 ||||  ||| || ||||   |     |||||||| ||| |||   ||  |||||\-+--++++-++++++++++----+---++-+--+-+++---+--/  |||  | | ||  |||||    |   |||   | |||| ||||| | 
 ||||  ||| || ||||   |     ||||||||/+++-+++---++--+++++--+--++++-++++++++++----+---++-+--+-+++--\|     |||  | | ||  |||||    |   |||   | |||| ||||| | 
 ||||  ||| || ||||  /+-----++++++++++++-+++---++--+++++--+--++++-++++++++++----+---++-+\ | |||  ||     |||  | | ||  ||\++----+---+++---+-++++-++/|| | 
 |||\--+++-++-++++--++-----++++++++++++-+++---++--+++++--+--++++-+/||||||||    |   || || | |||  ||     |||  | | ||  || ||    |   |||   | |||| || || | 
 |||   ||| || ||||  ||     |||||||||||| |||   ||  |||||  |/-++++-+-++++++++----+---++-++-+-+++--++-----+++-\| | ||  || ||    |   |||   | |||| || || | 
 |||   ||| || ||||  ||     |||||||||||| |||   ||  |||||  || |||| | ||||||||    |   || || | |||  ||     ||| || | ||  || ||    |   |||   | |||| || || | 
 |||   ||| || ||||  ||     |||||||||||| |||   || /+++++--++-++++-+-++++++++----+---++-++-+-+++--++-----+++-++-+-++--++-++----+---+++---+\|||| || || | 
 |||/--+++-++-++++--++-----++++++++++++-+++---++-++++++--++-++++-+-++++++++----+---++-++-+-+++\ ||     ||| || | ||  || ||    |   |||   |||||| || || | 
 ||||  ||| || ||||  ||     |||||||||||| |||   || ||||||  || |||| | ||||||||    |   || || | |||| ||     ||| || | ||  || ||    |   |||   |||||| || || | 
 ||||  ||| || ||||  ||     |||||||||||| |||   || ||||||  || |||| | ||||||||    |   || \+-+-++++-++-----+++-++-+-++--++-++----+---+++---++++/| || || | 
 ||||  ||| || ||||  ||     |||||||||||| |||   || ||||||  || |||| | ||||||||    |   |\--+-+-++++-++-----+++-++-+-++--++-++----+---++/   |||| | || || | 
 \+++--+++-++-++++--++-----+++/|||||||| |||   || ||||||  || |||| | ||||||||    |   |   | | |||| |^     ||| || | ||  || ||    |   ||    |||| | || || | 
  |||  ||| || ||||  ||     ||| |||||||| |||   || ||\+++--++-++++-+-++++++++----+---+---+-+-++++-++-----/|| || | ||  || ^|    |   ||    |||| | || || | 
  |||  \++-++-++++--++-----+++-++++++++-+++---++-++-+++--++-++++-+-/|||||||    |   |   | | |||| ||      || || | ||  || ||    |   ||    |||| | || || | 
  |||   || || ||||  ||     ||| |||||||| |||   || || |||  || |||| |  ||\++++----/   |   |/+-++++-++------++-++-+-++--++-++---\|   ||    |||| | || || | 
  |||   || || ||||  ||     ||| |||||||| |||   || || |||  || |||| |  || ||||      /-+---+++-++++-++------++-++-+-++--++-++---++---++----++++-+-++\|| | 
  |||   || || ||||  ||     ||| |||||||| |||   || || |||  || \+++-+--++-++++------+-+---+++-/||| ||      || || | ||  || ||   ||   ||    |||| | ||||| | 
  |||  /++-++-++++--++-----+++-++++++++-+++---++-++-+++--++--+++-+--++-++++------+-+---+++--+++-++\/----++-++-+-++--++-++---++---++----++++-+\||||| | 
  |||  ||| || ||||  ||     ||| |||||||\-+++---++-++-+++--++--+/| |  || ||||      | |   |||  ||| ||||    || || | ||  || ||   ||   ||    |||| ||||||| | 
  |||  ||| || |||\--++-----+++-+++++++--+++---++-++-+++--++--+-+-+--++-++++------+-+---+++--+++-++++----++-++-+-++--++-++---+/   ||    |||| ||||||| | 
  |||  ||| || |||   ||     ||| |||||||  |||   || || \++--++--+-+-+--++-++++------+-+---+++--+++-++++----++-++-+-/|  || ||   |    ||    |||| ||||||| | 
  \++--+++-++-+++---++-----+++-+++++++--+++---++-++--+/  ||  |/+-+--++-++++------+-+---+++--+++-++++----++\|| |  |  || ||   |    ||    |||| ||||||| | 
   ||  ||| || |||   \+-----+++-+++++++--+++---++-++--+---++--+++-+--++-++++------+-+---/||  ||| ||||    ||||| |  |  || ||   |    ||    |||| ||||||| | 
   ||  ||| || |||    \-----+++-+++++/|  |||   || ||  \---++--+++-+--++-++++------+-+----++--+++-++++----+/||| |  |  || ||   |    ||    |||| ||||||| | 
   ||  ||| || |||          ||| \++++-+--+/|   \+-++------++--+++-+--++-++++------+-+----++--+++-++++----+-+++-+--+--++-++---+----++----++++-++/|||| | 
   ||  ||| || |||          |||  |||| |  | |    | ||      ||  ||| | /++-++++------+-+-\  ||  ||| ||||    | ||| |  |  || ||   |    ||    |||| || |||| | 
   ||  ||| || |||/---------+++--++++-+--+-+----+-++------++--+++-+-+++-++++------+-+-+--++-\||| ||||    | ||| |  |  || ||   |    ||    |||| || |||| | 
   ||  ||| || ||||         |||  |||| |  \-+----+-++------++--+++-+-+++-++++------+-+-+--++-++++-++++----+-+++-/  |  || ||   |    ||    |||| || |||| | 
   ||  ||| || ||||         |||  |||| |    |    | ||      ||  ||| | ||| |\++------+-+-+--++-++++-++++----+-+++----+--++-++---+----++----++++-++-+++/ | 
   ||  ||| || ||||         |||  |||| \----+----+-++------++--+++-+-+++-+-++------+-+-+--+/ |||| ||||    | |||    |  || ||   |    ||    |||| || |||  | 
   ||  ||| |\-++++---------+++--+/||      |    | ||      ||  ||| | ||| | ||      | | |  |  |||| ||||    \-+++----/  || ||   |    ||    \+++-++-+++--/ 
   ||  ||| |  ||||  /------+++--+-++\     |    | ||      ||  ||| | ||| | \+------+-+-+--+--++++-++++------+++-------++-++---+----++-----++/ || |||    
   ||  ||| |  ||||  |      |||  \-+++-----+----+-++------++--+++-+-+++-+--+------+-+-+--+--+/|| ||||      |||       || ||   |    ||     ||  || |||    
   ||  ||| |  ||||  |      |||    |||     |    | ||      ||  ||| | ||| |  |      | | |  |  | || ||||      |||       || ||   |    ||     ||  || |||    
   ||  ||| |  |||| /+------+++----+++-----+----+-++------++--+++-+-+++-+--+------+-+-+--+--+-++-++++------+++-----\ || ||   |    ||     ||  || |||    
   ||  ||| |  |||| ||      |\+----+++-----+----+-++------++--+++-+-++/ |  |      | |/+--+--+-++-++++------+++-----+-++-++---+----++----\||  || |||    
   ||  ||| |  |||| ||      | |    |||     |    | ||      ||  |\+-+-++--+--+------+-+++--+--+-++-++++------/||  /--+-++-++---+\   ||    |||  || |||    
   \+--+++-+--++++-++------/ |    |||     \----+-++------++--+-+-+-++--+--+------+-+++--+--+-/| ||||       ||  |  | || ||   ||   ||    |||  || |||    
    |  ||| |  |\++-++--------+----+++----------+-++------++--/ | | \+--+--+------+-++/  |  |  | ||||       ||  |  | || ||   ||   ||    |||  || |||    
    |  ||| |  | || ||    /---+----+++----------+\||      ||    | |  |  |  |      | ||   |  |  | ||||       ||  |  | || ||   ||   ||    |||  || |||    
    |  ||| |  | || ||    |   |    |||          ||||      ||    | |  |  |  |      | ||   \--+--+-++++-------++--+--+-++-++---/|   ||    |||  || |||    
    |  ||| |  | || ||    |   |    |||          ||||      ||    | |  |  |  |      | \+------+--+-++++-------++--+--+-+/ \+----+---/|    |||  || |||    
    |  ||| |  | || ||    |   |    |||          ||||      ||    | |  |  |  \------+--+------+--+-++++-------++--+--+-/   |    |    |    |||  || |||    
    \--+++-+--+-++-++----+---+----+++----------++++------++----+-+--+--+----<----+--+------+--/ ||||       ||  |  |     |    |    |    |||  || |||    
       \++-+--+-++-++----+---+----+++----------++++------++----+-+--+--+---------+--+------+----++/|       ||  |  |     |    |    |    |||  || |||    
        || |  | || ||    |   |    |||     /----++++------++----+-+--+--+---------+--+------+----++-+-------++--+-\|     |    |    |    |||  || |||    
        || |  | || ||/---+---+----+++-----+----++++------++----+-+--+--+---------+--+------+----++-+-------++--+-++-----+----+-\  |    |||  || |||    
        || |  | || |||   |   |    |||     |    ||||      ||    | |  |  |         \--+------+----++-+-------++--+-++-----+----+-+--+----+++--++-+/|    
        |\-+--+-++-+++---+---+----+++-----+----++++------++-<--/ |  |  |            |      |    || |       ||  | ||     |    | |  |    |||  || | |    
        |  |  | || |||   |   |    |||     |    ||||      ||      |  |  |            |      |    || \-------++--+-++-----+----+-+--+----+++--+/ | |    
       /+--+--+-++-+++---+---+----+++-----+----++++------++------+--+--+------------+----\ |    ||         ||  | ||     |    | |  |    |||  |  | |    
       ||  |  | |\-+++---+---+----+++-----+----++++------++------+--+--+------------+----+-/    ||         ||  | ||     |    | |  |    |||  |  | v    
       ||  |  | |  |||   |   |    |\+-----+----++++------++------+--+--+------------+----+------/|         ||  | ||     |    | |  |    |||  |  | |    
       ||  |  | |  \++---+---+----+-+-----+----++++------++------+--+--+------------+----+-------+---------++--+-+/     |    | |  |    |||  |  | |    
       ||  |  \-+---++---+---/    | |     \----++++------++------+--+--+------------+----+-------+---------++--+-/      |    | |  |    |||  |  | |    
       ||  |    \---++---+--------/ |          ||||      ||      |  |  |            |    |       |         |\--+--------/    | |  |    |||  |  | |    
       ||  |        ||   |          |          ||||      ||      |  |  |            \----+-------+---------+---+-------------+-+--+----/||  |  | |    
       ||  \--------++---+----------+----------++++------++------/  |  |                 |       |         |   |             | |  |     ||  |  | |    
       ||           ||   |          |          ||||      ||         |  \-----------------+-------+---------+---+----<--------+-+--+-----+/  |  | |    
       ||           |\---+----------+----------++++------++---------+--------------------+-------+---------+---+-------------+-/  |     |   |  | |    
       ||           |    |          |          |||\------++---------/                    |       |         |   |             |    |     |   |  | |    
       |\-----------+----+----------+----------/||       ||                              |       \---------+---+-------------+----+-----+---+--/ |    
       \------------+----+----------+-----------++-------++------------------------------/                 |   |             |    \-----+---/    |    
                    |    |          |           ||       \+------------------------------------------------+---+-------------+----------+--------/    
                    |    \----------+-----------/|        \------------------------------------------------/   |             |          |             
                    \---------------/            |                                                             \-------------/          |             
                                                 \--------------------------------<-----------------------------------------------------/             `
